<!DOCTYPE html>
<html>

<head>
  <title>Login</title>
  <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.js"></script>
  <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.43.0/mapbox-gl.css" rel="stylesheet" />


<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.min.css">
</head>


<h1>THIS IS THE LOCATION PAGE</h1>
<img src="<%= spot[0].image %>">
<h2><%= spot[0].spot_name %></h2>
<h3>Type: <%= spot[0].type %></h3>
<h4><%= spot[0].spot_location %></h4>
<h6>Upvotes: <%= spot[0].upvotes %></h6>
<h6>Sketch Level: <%= spot[0].sketch_level %></h6>

<p>user: <%= user[0].full_name %></p>
<p>email: <%= user[0].email %></p>
  <a href="success">Click me!</a>


<!-- MAAAAPPPPP -->

<!-- map styles to be moved to css -->
<div id="map" style="width: 250px; height: 250px">
  <style>
    .marker {
      background-image: url('../images/skater.png');
      background-size: cover;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      /* cursor: pointer; */
    }

    .mapboxgl-popup {
      max-width: 200px;
    }

    .mapboxgl-popup-content {
      text-align: center;
      font-family: 'Open Sans', sans-serif;
    }
  </style>




<script>
  var points = <%- feature %>
</script>
</div>


<script>
// create new map ...options to set center point to where the map starts out

mapboxgl.accessToken = "pk.eyJ1IjoibWF3YXJyZW4iLCJhIjoiY2piZmdlODFuMnlzejJycGU2amoxdG44NyJ9.GlbjGsu0VqzCls45AniQgw";

var map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v9',
  center: points.features[0].geometry.coordinates,
  zoom: 13
});

// track user location

map.addControl(new mapboxgl.GeolocateControl({
  positionOptions: {
    enableHighAccuracy: true
  },
  trackUserLocation: true
}));




/* add a layer to the map that consists of the point location information in geoJSON format */
map.on('load', function(e) {

  map.addLayer({
    "id": "locations",
    "type": "symbol",
    // geoJSON object containing location coordinates
    "source": {
      "type": "geojson",
      "data": points  // data passed in from map route (feature)
    },
    "layout": {
      // can set icon image here
      "icon-image": "icon",
      "icon-allow-overlap": true,
    }
  })

});
//});

var nav = new mapboxgl.NavigationControl();
map.addControl(nav, 'top-left');
// add markers to map
points.features.forEach(function(marker) {

  // create a HTML element for each feature
  var el = document.createElement('div');
  el.className = 'marker';

  // make a marker for each feature and add to the map
  new mapboxgl.Marker(el)
    .setLngLat(marker.geometry.coordinates)
    .addTo(map);
});
</script>








</html>
